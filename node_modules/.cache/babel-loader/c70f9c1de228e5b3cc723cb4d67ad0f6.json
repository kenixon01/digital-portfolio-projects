{"ast":null,"code":"'use strict';\n\nconst KillCursor = require('../connection/commands').KillCursor;\nconst MongoError = require('../error').MongoError;\nconst MongoNetworkError = require('../error').MongoNetworkError;\nconst collectionNamespace = require('./shared').collectionNamespace;\nconst maxWireVersion = require('../utils').maxWireVersion;\nconst emitWarning = require('../utils').emitWarning;\nconst command = require('./command');\nfunction killCursors(server, ns, cursorState, callback) {\n  callback = typeof callback === 'function' ? callback : () => {};\n  const cursorId = cursorState.cursorId;\n  if (maxWireVersion(server) < 4) {\n    const bson = server.s.bson;\n    const pool = server.s.pool;\n    const killCursor = new KillCursor(bson, ns, [cursorId]);\n    const options = {\n      immediateRelease: true,\n      noResponse: true\n    };\n    if (typeof cursorState.session === 'object') {\n      options.session = cursorState.session;\n    }\n    if (pool && pool.isConnected()) {\n      try {\n        pool.write(killCursor, options, callback);\n      } catch (err) {\n        if (typeof callback === 'function') {\n          callback(err, null);\n        } else {\n          emitWarning(err);\n        }\n      }\n    }\n    return;\n  }\n  const killCursorCmd = {\n    killCursors: collectionNamespace(ns),\n    cursors: [cursorId]\n  };\n  const options = {};\n  if (typeof cursorState.session === 'object') options.session = cursorState.session;\n  command(server, ns, killCursorCmd, options, (err, result) => {\n    if (err) {\n      return callback(err);\n    }\n    const response = result.message;\n    if (response.cursorNotFound) {\n      return callback(new MongoNetworkError('cursor killed or timed out'), null);\n    }\n    if (!Array.isArray(response.documents) || response.documents.length === 0) {\n      return callback(new MongoError(`invalid killCursors result returned for cursor id ${cursorId}`));\n    }\n    callback(null, response.documents[0]);\n  });\n}\nmodule.exports = killCursors;","map":{"version":3,"names":["KillCursor","require","MongoError","MongoNetworkError","collectionNamespace","maxWireVersion","emitWarning","command","killCursors","server","ns","cursorState","callback","cursorId","bson","s","pool","killCursor","options","immediateRelease","noResponse","session","isConnected","write","err","killCursorCmd","cursors","result","response","message","cursorNotFound","Array","isArray","documents","length","module","exports"],"sources":["C:/Users/minix/Documents/GitHub/digital-portfolio-projects/digital-portfolio-projects/node_modules/mongodb/lib/core/wireprotocol/kill_cursors.js"],"sourcesContent":["'use strict';\n\nconst KillCursor = require('../connection/commands').KillCursor;\nconst MongoError = require('../error').MongoError;\nconst MongoNetworkError = require('../error').MongoNetworkError;\nconst collectionNamespace = require('./shared').collectionNamespace;\nconst maxWireVersion = require('../utils').maxWireVersion;\nconst emitWarning = require('../utils').emitWarning;\nconst command = require('./command');\n\nfunction killCursors(server, ns, cursorState, callback) {\n  callback = typeof callback === 'function' ? callback : () => {};\n  const cursorId = cursorState.cursorId;\n\n  if (maxWireVersion(server) < 4) {\n    const bson = server.s.bson;\n    const pool = server.s.pool;\n    const killCursor = new KillCursor(bson, ns, [cursorId]);\n    const options = {\n      immediateRelease: true,\n      noResponse: true\n    };\n\n    if (typeof cursorState.session === 'object') {\n      options.session = cursorState.session;\n    }\n\n    if (pool && pool.isConnected()) {\n      try {\n        pool.write(killCursor, options, callback);\n      } catch (err) {\n        if (typeof callback === 'function') {\n          callback(err, null);\n        } else {\n          emitWarning(err);\n        }\n      }\n    }\n\n    return;\n  }\n\n  const killCursorCmd = {\n    killCursors: collectionNamespace(ns),\n    cursors: [cursorId]\n  };\n\n  const options = {};\n  if (typeof cursorState.session === 'object') options.session = cursorState.session;\n\n  command(server, ns, killCursorCmd, options, (err, result) => {\n    if (err) {\n      return callback(err);\n    }\n\n    const response = result.message;\n    if (response.cursorNotFound) {\n      return callback(new MongoNetworkError('cursor killed or timed out'), null);\n    }\n\n    if (!Array.isArray(response.documents) || response.documents.length === 0) {\n      return callback(\n        new MongoError(`invalid killCursors result returned for cursor id ${cursorId}`)\n      );\n    }\n\n    callback(null, response.documents[0]);\n  });\n}\n\nmodule.exports = killCursors;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}